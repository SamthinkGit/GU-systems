<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://SamthinkGit.github.io/GU-systems/Architecture-Guide/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Introduction - Execution Cognition Machine (ECM)</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Execution Cognition Machine (ECM)</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">ðŸŒŸ GU-Systems: ECM approximation to Computer Autonomous AI ðŸŒŸ</a>
                            </li>
                            <li class="nav-item">
                                <a href="../AgentProtocol/" class="nav-link">AgentProtocol</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Bibliography/" class="nav-link">Bibliography</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Cognition-Layer-API-%28Planex%29/" class="nav-link">Cognition Layer API</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ECM-Problem-Analysis/" class="nav-link">ECM Problem Analysis</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Exelent/" class="nav-link">Exelent</a>
                            </li>
                            <li class="nav-item">
                                <a href="../FastAgentProtocol/" class="nav-link">FastAgentProtocol Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../FastReact/" class="nav-link">FastReact</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Home/" class="nav-link">ðŸŒŸ GU-Systems: ECM approximation to Computer Autonomous AI ðŸŒŸ</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Interpreter/" class="nav-link">Interpreter</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ItemRegistry/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../LLMs-and-State-of-Art/" class="nav-link">LLMs and State of Art</a>
                            </li>
                            <li class="nav-item">
                                <a href="../MouseAgent-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Planex-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Planex/" class="nav-link">Planex as an Approximation to $A_1$</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Pyxcel-Interpreter/" class="nav-link">Pyxcel Interpreter</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ROSA-Interpreter/" class="nav-link">ROSA Interpreter</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ROSA/" class="nav-link">Using ROSA (ROS Agent)</a>
                            </li>
                            <li class="nav-item">
                                <a href="../RePlan-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Remote-Execution/" class="nav-link">ECM Server/Client</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Rosa-Insights/" class="nav-link">Implementation of the Execution Layer Algorithm with ROSA ($A_2$)</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Self%E2%80%90Training-Agents/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../SimpleCognitiveMemory/" class="nav-link">SimpleCognitiveMemory Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../System-Architecture-Overview/" class="nav-link">System Architecture Overview</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Theoretical-Fundamentals/" class="nav-link">Theoretical Fundamentals</a>
                            </li>
                            <li class="nav-item">
                                <a href="../What-is-GU/" class="nav-link">What is GU</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Xplore-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../_Footer/" class="nav-link"> Footer</a>
                            </li>
                            <li class="nav-item">
                                <a href="../_Sidebar/" class="nav-link"> Sidebar</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../AgentProtocol/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Bibliography/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/SamthinkGIt/GU-systems/edit/master/docs/Architecture-Guide.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#introduction" class="nav-link">Introduction</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#base-execution-diagram-for-the-ecm" class="nav-link">Base Execution Diagram for the ECM</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#cognition-layer-agent" class="nav-link">Cognition Layer Agent</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#fastagentprotocol" class="nav-link">FastAgentProtocol</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#ecm-core" class="nav-link">ECM Core</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#interpreter" class="nav-link">Interpreter</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#execution-layer-module" class="nav-link">Execution Layer Module</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#action-space" class="nav-link">Action Space</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#conclusion" class="nav-link">Conclusion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="introduction">Introduction</h1>
<p>In this guide, you will gain a deep understanding of the ECM architecture implemented in this repository. We will explore the main modules and core approaches to solving the ECM problem. It is recommended that you first read the <a href="Theoretical-Fundamentals">Theoretical Fundamentals</a> and the <a href="System-Architecture-Overview">Architecture Overview</a> guides.</p>
<p>The primary challenge of an ECM lies in synchronizing multiple layers. Although an ECM can be approached with various architectures, this repository divides all modules into four layers:
- <a href="../blob/main/cognition_layer"><code>/cognition_layer</code></a>: This directory contains all the AI agents responsible for thinking, planning, reasoning, and all necessary components to fully <strong>build and deploy those agents</strong>, generally adhering to the Agent Protocol Standard.
- <a href="../blob/main/ecm"><code>/ecm</code></a>: This directory holds all the mediators, communicators, and middleware between the execution layer and the cognition layer. <strong>Only templates and virtual functions reside here</strong>, allowing the cognition layer to interact with the execution layer through any implementation using templates such as an Interpreter. Additionally, tools that can be used in both execution and cognition layers, such as the Exelent Parser or the Item Registry, are found here.
- <a href="../blob/main/execution_layer"><code>/execution_layer</code></a>: This directory includes all modules that assist agents in <strong>executing commands</strong>, typically communicated using the <a href="Exelent">Exelent</a> language. Here, you can find thread managers, registries, callbacks, etc.
- <a href="../blob/main/action_space"><code>/action_space</code></a>: This directory defines <strong>all the actions that agents can take</strong>. By importing these modules, you add new interactions to your agent, with actions resolved by the execution layer. Modules for keyboard interaction, window management, etc., can be found here.</p>
<h2 id="base-execution-diagram-for-the-ecm">Base Execution Diagram for the ECM</h2>
<p>Each layer in this architecture plays a crucial role in ensuring the efficiency, coherence, and functionality of the AI system. The following diagram illustrates the main execution flow of the ECM. The upper layers focus on cognitive interactions and decision-making, while the lower layers handle practical execution and management of specific functions. This separation of responsibilities allows for better organization and facilitates maintenance and scalability of the system.</p>
</div>
<div align="center">
  <img src="https://github.com/user-attachments/assets/32edd68e-7226-4fc7-9376-54d453d0f861" alt="ECM Layers Diagram" width=450>
</div>

<h2 id="cognition-layer-agent">Cognition Layer Agent</h2>
<p>The <strong>Cognition Layer Agent</strong> is responsible for interacting with the LL. Its primary function is to handle problems by receiving a user query and generating a response to that problem, generally returning <strong>Exelent code</strong>. For this implementation, the agent can use tools, multiple steps, requests to the LLM, etc. Regardless of the agent's internal workings, the external interface behaves as an iterator, where each step of the agent is controlled by lower layers.</p>
<p>Some implementations of this layer can be found in the <a href="../blob/main/cognition_layer">/cognition_layer/[module]/agents</a> directory, where each agent follows different architectures. Here are some examples:</p>
<ul>
<li><a href="../blob/main/cognition_layer/planex/agents">/planex</a>: <strong>Planex</strong> uses three different agents (Planification, Reduction, Translation) executed sequentially. Each agent contains a function <code>.plan()</code>, <code>.reduce()</code>, or <code>.translate()</code> to chain the generated data from the LLM, returning a string with the generated plan.</li>
<li><a href="../blob/main/cognition_layer/planexv2/agents/planexv2.py">/planexv2</a>: <strong>PlanexV2</strong> reuses the code of the original Planex agent but implements a new <code>Blamer</code> agent that checks if the code is correct. If not, it executes the failed agent again until obtaining a valid plan.</li>
<li><a href="../blob/main/cognition_layer/RePlan/agents/replan.py">/RePlan</a>: <strong>RePlan</strong> uses ReAct architecture to control the execution of the generated code. It uses PlanexV2 for generating Exelent files, and once generated, it manages the interpreters to approve, control, and check the execution of the plan.</li>
</ul>
<blockquote>
<p>Note that all these agents depend on a set of prompts usually found in the directory <a href="../blob/main/cognition_layer/RePlan/agents/prompts.py">/cognition_layer/[agent]/agents/prompts.py</a>.</p>
</blockquote>
<p>Some implementations of these agents in action can be found in the <a href="../blob/main/tests/sandbox">/tests/sandbox</a> directory, where you can experiment with different queries.</p>
<p>Note also how some of these agents implement an <code>iter()</code> function, which returns a generator allowing you to easily execute all the steps of the agent. The messages returned may vary between different agents, but they can implement a <strong>Response model</strong> as a dataclass, where you can obtain information about each step.</p>
<pre><code class="language-python">agent = RePlan()
step: ReplanResponse

# In this case the generator is async, but this doesn't need to be true for all agents
async for step in replan.iter(query=&quot;Open the terminal in linux&quot;):
    print(f&quot;[{step.name}]&quot; + Style.RESET_ALL)
    print(step.content)
</code></pre>
<p>Further information about each agent can be found on the same file or by checking the wiki if it the agent has already been published.</p>
<h2 id="fastagentprotocol">FastAgentProtocol</h2>
<p>The <code>FastAgentProtocol</code> is a simplified and faster alternative to the previous <code>AgentProtocol</code>, which required server setups and remote API configurations. The new approach eliminates unnecessary complexity, enabling direct and efficient communication between agents and the main system.</p>
<blockquote>
<p>Note: This protocol can be found at <a href="../blob/main/cognition_layer/protocols/fast_ap.py">/cognition_layer/protocols/fast_ap.py</a></p>
</blockquote>
<ul>
<li><strong>Simplification</strong>: No more server setup or port management.</li>
<li><strong>Performance</strong>: Local execution reduces latency.</li>
<li><strong>Standardization</strong>: Provides a unified, consistent framework for agent integration.</li>
</ul>
<p>The <code>FastAgentProtocol</code> acts as a mediator between the main system and cognitive agents. It leverages an iterator-based approach, where the agent defines an iterative process that yields step-by-step progress. Each step includes information such as the step's name, content, and whether it's the final step.</p>
<blockquote>
<p>More information can be found in the FastAgentProtocol section on the wiki</p>
</blockquote>
<h2 id="ecm-core">ECM Core</h2>
<p>The <strong>Main Module</strong> or <strong>ECM Core</strong> can be found at <a href="../blob/main/ecm/core">/ecm/core</a> and contains the main execution loop of the system. This component is the operational core where all modules are managed. Here, you can test all agents. These agents are implemented at the top of the file and will be executed until stopped by the user.</p>
<p>Here are some properties of this module:</p>
<ul>
<li>This module does not depend on the implementations or internals of the cognition/execution layers; it uses only the virtual interfaces/APIs from the middlewares.</li>
<li>By default, all agent actions are deactivated in the host for safety reasons. Instead of executing, the actions will only log a simulation of each action's execution (keyboard, mouse control, etc. CognitionLayer steps are not included, only Action space). If you want to run an agent on the host machine with full integration, use <a href="../blob/main/ecm/core/run_in_host.py">/ecm/core/run_in_host.py</a>.</li>
</ul>
<p>You can run this module using the following command:</p>
<pre><code class="language-bash">python ecm/core/main.py --debug --agent [Planex|PlanexV2|RePlan...]
</code></pre>
<p>You can also use <code>-h</code> for more information about the arguments.</p>
<pre><code>python ecm/core/main.py -h
</code></pre>
<h2 id="interpreter">Interpreter</h2>
<p>The <strong>Interpreter</strong> unifies all executors within a single framework, allowing the system to execute functions and read commands from Exelent files. All interpreters must satisfy the attributes defined in the virtual class found at <a href="../blob/main/ecm/mediator/Interpreter.py">/ecm/mediator/Interpreter.py</a>. This means all interpreters must contain the following properties:</p>
<ol>
<li>Contain and inherit all the methods and attributes defined in the virtual Interpreter class.</li>
<li>Define a supports class for assigning all properties that can be used (at least the contained properties, extendable as needed) by inheriting from the InterpreterSupports class.</li>
<li>If the Interpreter supports feedback returning, it must return a Feedback Object that is a <strong>subclass</strong>, inheriting from the Feedback class defined in <a href="../blob/main/ecm/mediator/feedback.py">/ecm/mediator/feedback.py</a> and defining all specified methods/properties. Note that all feedback generated must always contain an <code>_exec_code</code> to define the status of the execution, using the <code>ExecutionStatus(Enum)</code> class defined in <a href="../blob/main/ecm/mediator/feedback.py">/ecm/mediator/feedback.py</a>.</li>
</ol>
<h2 id="execution-layer-module">Execution Layer Module</h2>
<p>The <strong>Execution Layer Module</strong> manages the execution of functions within the system. This component coordinates and oversees the operation of various threads, functions, callbacks, etc., needed for building the interpreter and achieving the full execution of multiple tasks and different behaviors defined in the Exelent language. This module can vary significantly, making it challenging to establish a standard implementation. However, you can explore the <a href="Rosa-Insights">ROSA Insights</a> to further investigate the key problems of this layer.</p>
<h2 id="action-space">Action Space</h2>
<p>The <strong>Action Space</strong> consists of executable functions that can be run on the host. It represents the set of actions and commands available for the AI to carry out in response to requests and tasks assigned. It should contain multiple functions to facilitate the actions of the Agents. These functions have the following properties:</p>
<ol>
<li>They can raise feedback if the interpreter that calls those functions enables it, but it is better to directly return information to the agent and save statuses between calls.</li>
<li>They must always receive <code>str</code> or <code>list[str]</code> as arguments and return <code>str</code> because they will be managed by an AI with words.</li>
<li>They should be as simple and straightforward as possible. Avoid more than 2 arguments per function.</li>
<li>They must always contain a docstring explaining their functionality and how to use them. This docstring will be shown to the agents.</li>
</ol>
<p>These actions can be defined anywhere, but it is standard to define them in the <a href="../blob/main/action_space">/action_space</a> directory. To define them, you just have to use the Item Registry as follows:</p>
<pre><code class="language-python">from ecm.tools.registry import ItemRegistry

@ItemRegistry.register(type=&quot;action&quot;)
def hello_world():
    &quot;&quot;&quot;Says hello world.\nUsage: hello_world()&quot;&quot;&quot;  # noqa
    print(&quot;Hello World!&quot;)
</code></pre>
<p>If you want the Agents to have multiple names for using you function you can use the <code>alias</code> function of the Item Registry. This will improve the AI's ease and probability to use your tool.</p>
<pre><code class="language-python">@ItemRegistry.alias([
  &quot;say_hello_world&quot;,
  &quot;greet&quot;
])
@ItemRegistry.register(type=&quot;action&quot;)
def hello_world():
    &quot;&quot;&quot;Says hello world.\nUsage: hello_world()&quot;&quot;&quot;  # noqa
    print(&quot;Hello World!&quot;)
</code></pre>
<blockquote>
<p>Note: Don't use more than 3 aliases if it isn't necessary, each alias results in more tokens parsed by the Agent.</p>
</blockquote>
<p>Finally, note that all these functions must be imported in order to be registered in the ItemRegistry. Therefore, in multiple files, you will find imports like the following, even though they are not used in the file:</p>
<pre><code class="language-python">import action_space.talk.greet # noqa
</code></pre>
<blockquote>
<p>Note: More information about the ItemRegistry can be found on its own section at the wiki.</p>
</blockquote>
<h1 id="conclusion">Conclusion</h1>
<p>This guide has provided a comprehensive overview of the ECM architecture implemented in this repository, detailing its layered structure and key components.</p>
<p>Each layer and module plays a vital role in the overall architecture. By adhering to the defined standards and protocols, the system achieves a high level of integration and functionality, capable of synchronizing both cognition and execution layer.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
