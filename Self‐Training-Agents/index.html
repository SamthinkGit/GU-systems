<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://SamthinkGit.github.io/GU-systems/Self%E2%80%90Training-Agents/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Introduction - Execution Cognition Machine (ECM)</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Execution Cognition Machine (ECM)</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">🌟 GU-Systems: ECM approximation to Computer Autonomous AI 🌟</a>
                            </li>
                            <li class="nav-item">
                                <a href="../AgentProtocol/" class="nav-link">AgentProtocol</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Architecture-Guide/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Bibliography/" class="nav-link">Bibliography</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Cognition-Layer-API-%28Planex%29/" class="nav-link">Cognition Layer API</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ECM-Problem-Analysis/" class="nav-link">ECM Problem Analysis</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Exelent/" class="nav-link">Exelent</a>
                            </li>
                            <li class="nav-item">
                                <a href="../FastAgentProtocol/" class="nav-link">FastAgentProtocol Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../FastReact/" class="nav-link">FastReact</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Home/" class="nav-link">🌟 GU-Systems: ECM approximation to Computer Autonomous AI 🌟</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Interpreter/" class="nav-link">Interpreter</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ItemRegistry/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../LLMs-and-State-of-Art/" class="nav-link">LLMs and State of Art</a>
                            </li>
                            <li class="nav-item">
                                <a href="../MouseAgent-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Planex-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Planex/" class="nav-link">Planex as an Approximation to $A_1$</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Pyxcel-Interpreter/" class="nav-link">Pyxcel Interpreter</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ROSA-Interpreter/" class="nav-link">ROSA Interpreter</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ROSA/" class="nav-link">Using ROSA (ROS Agent)</a>
                            </li>
                            <li class="nav-item">
                                <a href="../RePlan-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Remote-Execution/" class="nav-link">ECM Server/Client</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Rosa-Insights/" class="nav-link">Implementation of the Execution Layer Algorithm with ROSA ($A_2$)</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../SimpleCognitiveMemory/" class="nav-link">SimpleCognitiveMemory Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../System-Architecture-Overview/" class="nav-link">System Architecture Overview</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Theoretical-Fundamentals/" class="nav-link">Theoretical Fundamentals</a>
                            </li>
                            <li class="nav-item">
                                <a href="../What-is-GU/" class="nav-link">What is GU</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Xplore-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../_Footer/" class="nav-link"> Footer</a>
                            </li>
                            <li class="nav-item">
                                <a href="../_Sidebar/" class="nav-link"> Sidebar</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../Rosa-Insights/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../SimpleCognitiveMemory/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/SamthinkGIt/GU-systems/edit/master/docs/Self‐Training-Agents.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#introduction" class="nav-link">Introduction</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#specialization-architecture" class="nav-link">Specialization Architecture</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#self-training-architecture" class="nav-link">Self-Training Architecture</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="introduction">Introduction</h1>
<p>In the paper <a href="https://arxiv.org/pdf/2203.14465">Self-Trained Agents</a> a research about training agents with an iterative mechanism is explored. As its fundamentals, the main process is to fine-tune an LLM by forcing it to reason about its world, correcting it and fine-tuning the agent with its own outputs. By using this process, we are able to fine-tune an agent without using a human generated.</p>
<p>In this repository we will take use of this methodology in order to fine-tune the Cognition Layer ($A_1$) Agents in order to minimize the costs, delay and empower the reasoning capabilities of LLMs.</p>
<h2 id="specialization-architecture">Specialization Architecture</h2>
<p>At the <a href="https://github.com/SamthinkGit/GU-systems/blob/main/cognition_layer/again/tools/specialization.py">specialization.py</a> module we can find a simple AI graph to implement Self-Training. This module can be used in order to generate samples (for a bigger dataset) that ensures the reasoning about a task is successful. The main algorithm uses the following steps:</p>
<ol>
<li>
<p><strong>Try</strong>: Receive the task from the user as a prompt, it then tries to generate an action that solves that query and predict the result that its action will generate in the user environment.</p>
<blockquote>
<p><em>Human: <code>"Open the firefox browser"</code></em></p>
<p>AI: {<code>reasoning="The display..."</code>, <code>action="open("Amazon")</code>, <code>learning=None</code>, <code>expectation="The window will open"</code>}</p>
</blockquote>
</li>
<li>
<p><strong>Test</strong>: An <code>effect_descriptor</code> object is passed to the AI, this descriptor will be responsible of generating a description of the latests effects in the AI environment. With this description, the AI reasons if the expectation has been completed, and if so, the last reasoning will be returned for saving it as a sample.</p>
</li>
<li>
<p><strong>Learn</strong>: If the test has failed, then the AI tries to generate new learnings, reasoning about its failures and how it could overcome it in the next iteration. Reset the environment and return to the try node.</p>
</li>
<li>
<p><strong>Try</strong>: Iterate over the steps 1 to 3 adding the learnings obtained from previous nodes to the prompt of the agent.</p>
</li>
</ol>
<div align="center">
  <img src="https://github.com/user-attachments/assets/9c3d17a6-ace8-434a-b50a-48cc835b926e" alt="Specialization Graph">
</div>

<p>An example usage of this module could be the following program:</p>
<pre><code class="language-python">if __name__ == &quot;__main__&quot;:
    # Build an executor (You could use for example RosaInterpreter...)
    def test(query):
      result = execute(query)
      return result

    # Build the graph
    graph = SpecializationGraph(
        action_prompt=&quot;You are an AI computer expert. You must provide...&quot;,
        test=test,
        effect_descriptor=lambda: describe_environment(),
        reset_state=lambda: reset_my_env(),
    ).compile()

    # Execute the graph and obtain a sample
    user_input = &quot;I want to do foo&quot;
    config = {&quot;configurable&quot;: {&quot;thread_id&quot;: str(random.randint(5000, 15000))}}
    for event in graph.stream({&quot;query&quot;: user_input}, config, stream_mode=&quot;values&quot;):
        print(&quot;=&quot; * 30)
        print(Fore.YELLOW + json.dumps(event, indent=4) + Fore.RESET)
</code></pre>
<h1 id="self-training-architecture">Self-Training Architecture</h1>
<p>At the <a href="https://github.com/SamthinkGit/GU-systems/blob/main/cognition_layer/again/tools/self_train.py">specialization.py</a> module you can find an alternative implementation of the previous architecture. In this case, we focus on improving the testing methods and making the architecture as an ubiquitous one. The main steps are the followng:</p>
<ol>
<li>
<p><strong>Try</strong>: Calls a function that will act emulating the "try" node of the Specialization graph, thus if the goal is to generate actions, the function will receive the user query, the learnings and previous failures in order to generate an action (function response)</p>
</li>
<li>
<p><strong>Execute</strong>: Calls a function that executes the action provided from the try node. In contrast with the specialization graph, the learn function must have a form to obtain the real solution of the query, if the solution is not correct, the learn node will be called. Also, if the maximum iterations of the agent have been reached, it will also fail, enabling to retry a new reasoning from the begging.</p>
</li>
<li>
<p><strong>Learn</strong>: Calls a function that contains generates a reasoning about what have failed and how it can be solved in posterior steps. The same architecture as in Specialization graph is used from now on.</p>
</li>
</ol>
<div align="center">
  <img src="https://github.com/user-attachments/assets/98c74070-3ee6-41ad-b3bd-4d00d559569e" alt="Self-Train Graph">
</div>

<p>An example usage of this module could be the following program:</p>
<pre><code class="language-python">if __name__ == &quot;__main__&quot;:

    # Build the graph
    graph = SelfTrainGraph(
        agent=lambda input: agent_reason(input),
        response_executor=lambda agent_output: execute(agent_output),
        test_approval=lambda execution_response: check(execution_response, expected),
        learner=lamda graph_status: agent_generate_learnings(graph_status),
        max_iterations=4, # If it fails more than 4 times exit.
    ).compile()

    # Run the graph
    user_input = &quot;...&quot;
    for event in graph.stream(
        {&quot;query&quot;: user_input, &quot;success&quot;: False, &quot;current_iterations&quot;: 0},
        stream_mode=&quot;values&quot;,
    ):
        result = event

    # Return sample
    return TrainingResponse(
        iterations=result[&quot;current_iterations&quot;],
        output=json.loads(result[&quot;response&quot;])[&quot;reasoning&quot;],
        success=result[&quot;success&quot;],
    )
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
