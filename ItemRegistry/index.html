<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://SamthinkGit.github.io/GU-systems/ItemRegistry/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Introduction - Execution Cognition Machine (ECM)</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Execution Cognition Machine (ECM)</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">ðŸŒŸ GU-Systems: ECM approximation to Computer Autonomous AI ðŸŒŸ</a>
                            </li>
                            <li class="nav-item">
                                <a href="../AgentProtocol/" class="nav-link">AgentProtocol</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Architecture-Guide/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Bibliography/" class="nav-link">Bibliography</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Cognition-Layer-API-%28Planex%29/" class="nav-link">Cognition Layer API</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ECM-Problem-Analysis/" class="nav-link">ECM Problem Analysis</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Exelent/" class="nav-link">Exelent</a>
                            </li>
                            <li class="nav-item">
                                <a href="../FastAgentProtocol/" class="nav-link">FastAgentProtocol Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../FastReact/" class="nav-link">FastReact</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Home/" class="nav-link">ðŸŒŸ GU-Systems: ECM approximation to Computer Autonomous AI ðŸŒŸ</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Interpreter/" class="nav-link">Interpreter</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../LLMs-and-State-of-Art/" class="nav-link">LLMs and State of Art</a>
                            </li>
                            <li class="nav-item">
                                <a href="../MouseAgent-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Planex-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Planex/" class="nav-link">Planex as an Approximation to $A_1$</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Pyxcel-Interpreter/" class="nav-link">Pyxcel Interpreter</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ROSA-Interpreter/" class="nav-link">ROSA Interpreter</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ROSA/" class="nav-link">Using ROSA (ROS Agent)</a>
                            </li>
                            <li class="nav-item">
                                <a href="../RePlan-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Remote-Execution/" class="nav-link">ECM Server/Client</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Rosa-Insights/" class="nav-link">Implementation of the Execution Layer Algorithm with ROSA ($A_2$)</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Self%E2%80%90Training-Agents/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../SimpleCognitiveMemory/" class="nav-link">SimpleCognitiveMemory Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../System-Architecture-Overview/" class="nav-link">System Architecture Overview</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Theoretical-Fundamentals/" class="nav-link">Theoretical Fundamentals</a>
                            </li>
                            <li class="nav-item">
                                <a href="../What-is-GU/" class="nav-link">What is GU</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Xplore-Insights/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../_Footer/" class="nav-link"> Footer</a>
                            </li>
                            <li class="nav-item">
                                <a href="../_Sidebar/" class="nav-link"> Sidebar</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../Interpreter/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../LLMs-and-State-of-Art/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/SamthinkGIt/GU-systems/edit/master/docs/ItemRegistry.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#introduction" class="nav-link">Introduction</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#initializing" class="nav-link">Initializing</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#adding-actions-and-tools" class="nav-link">Adding Actions and Tools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#loading-actions" class="nav-link">Loading Actions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#extracting-actions-and-tools" class="nav-link">Extracting Actions and Tools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#some-addons" class="nav-link">Some Addons</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#conclusion" class="nav-link">Conclusion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="introduction">Introduction</h1>
<p>The <a href="https://github.com/SamthinkGit/GU-systems/blob/main/ecm/tools/item_registry_v2.py">ItemRegistry</a> is a class designed similar to a database. Its main purpose is to store what we call Actions, Tools and Items in order to enable modules such as the Exelent Parser or the Interpreters to retrieve complex objects by just using its name (an string). In the following sections, you will learn how to use, interact and register your own items inside the ItemRegistry and some deprecations that you can still found in some directories.</p>
<h2 id="initializing">Initializing</h2>
<p>The ItemRegistry acts as a database, thus it is able to be shared between different layers and threads even when you don't have access to the same instance. For obtaining this, you can use 2 different types of instantiation:</p>
<ol>
<li>If you call the ItemRegistry without arguments, you will receive the <strong>default ItemRegistry</strong>, all the threads will share the same default instance.</li>
</ol>
<pre><code class="language-python">from ecm.tools.item_registry_v2 import ItemRegistry

obj_1 = object()
obj_2 = object()

registry_1 = ItemRegistry()
registry_2 = ItemRegistry()

print(obj_1 is obj_2) # -&gt; False
print(registry_1 is registry_2) # -&gt; True
</code></pre>
<ol>
<li>If you want to force the registry to maintain a separated database, <strong>you can add a name to you registry</strong>, this will return an empty registry that can be called from other threads only if they use the same name:</li>
</ol>
<pre><code class="language-python">from ecm.tools.item_registry_v2 import ItemRegistry

default_registry = ItemRegistry()
my_registry = ItemRegistry(name=&quot;different&quot;)
my_registry_2 = ItemRegistry(name=&quot;different&quot;)

print(default_registry is my_registry) # -&gt; False
print(my_registry is my_registry_2) # -&gt; True
</code></pre>
<p>For obtaining information about the current instances and its content you can use 2 funcions:</p>
<pre><code class="language-python">ItemRegistry.summary()
# We add some items...
</code></pre>
<pre><code class="language-bash">==================== Item Registry ====================
[default]
* (ACTION): Action(name='click', active=True, content=&lt;function click at 0x7607e0f7fa30&gt;, is_callable=True, description=&quot;Clicks with the mouse on the specified element. Example: click('Firefox Icon') or click('Navigation Bar'). Ensure to provide an especific description if needed.&quot;, labels=[])
* (TOOL): Tool(name='screenshot', active=True, content=&lt;function screenshot at 0x7607e79c8af0&gt;, is_callable=True, description='', labels=[])
[different]
* (TOOL): Tool(name='move_mouse_to', active=True, content=&lt;function move_mouse_to at 0x760800cee0e0&gt;, is_callable=True, description='', labels=[])
* (TOOL): Tool(name='send_click_event', active=True, content=&lt;function send_click_event at 0x7607e0f7f9a0&gt;, is_callable=True, description='', labels=[])
</code></pre>
<h2 id="adding-actions-and-tools">Adding Actions and Tools</h2>
<p>When working with agents we will want the AI to retrieve the function <code>use_my_mouse()</code> with only requesting to the agent a string that says: <code>"use_my_mouse"</code>. For this, since only some functions are targeted to be used by an AI, you must <strong>register</strong> your functions in the ItemRegistry.</p>
<p>Here it is important to differerentiate between two types of functions:
- <strong>Actions</strong>: These are those functions targeted to the AI, they should contain a docstring, be fully typed and clear and be simple to use. This means, you should at most receive one or two arguments (if any) and the use should be self-explanatory. Use arguments as <code>int</code> or <code>str</code> for best practices. A good action could be the following:</p>
<pre><code class="language-python">@ItemRegistry.register(type=&quot;action&quot;)
def close_app(name_of_the_app: str) -&gt; None:
  &quot;&quot;&quot;Closes an app by its name. The app should be active to be closed. Usage: close(&quot;firefox&quot;).&quot;&quot;&quot;
  app = my_app_retriever.retrieve(name_of_the_app)
  app.close()
  ...
</code></pre>
<ul>
<li><strong>Tools</strong>: These are functions that are stored in the ItemRegistry are not targeted to the AI but the developer. This can be defined as any other function.</li>
</ul>
<pre><code class="language-python">@ItemRegistry.register(type=&quot;tool&quot;)
def close_app(app_name: str, app_registry: AppRegistry, check_for_errors: bool = True) -&gt; None:
  &quot;&quot;&quot;
  Generates a summary of all the current apps
  &quot;&quot;&quot;
  ...
</code></pre>
<p>As you can see, all the actions and tools are registered by just using the <code>@ItemRegistry().register</code> decorator. Note that this decorator will be executed as the same time as the file is imported, for this reason, you will see multiple imports of actions when the developer wants the actions to be available. These functions should be saved in the <a href="https://github.com/SamthinkGit/GU-systems/tree/main/action_space">/action_space</a> directory, usually in a file called as <code>actions.py</code>.</p>
<pre><code class="language-python"># We use the `noqa` label to avoid intellisense or formatters to flag this import as an error
import action_space.experimental.screenshot.actions # noqa
</code></pre>
<h2 id="loading-actions">Loading Actions</h2>
<p>Following the Principle of Least Atonishment in python the imports that are used to save the actions/tools, are not fully loaded into the registry, so imports don't alter the functioning of your program. After you have selected which actions you have imported, they must be loaded in the ItemRegistry instance you want to work with.</p>
<p>For example, you can use the <code>load_all()</code> method to enable all tools and actions retrieved in the imports into a selected instance:</p>
<pre><code class="language-python">from ecm.tools.item_registry_v2 import ItemRegistry
import action_space.my_lib.actions # noqa

# No action avaliable
ItemRegistry.summary()

# Note that we are calling the default instance
ItemRegistry().load_all()

# All actions are available
ItemRegistry.summary()
</code></pre>
<p>If you want to load only a specific action, you can use the <code>load()</code> method:</p>
<pre><code class="language-python">ItemRegistry().load(&quot;screenshot&quot;)
</code></pre>
<p>Sometimes you will want to add multiple actions that are related, for example, all the keyboard utils. For this, the version V2 of the ItemRegistry enables the actions to be grouped inside a package. Then you can easily load them all at the same time.</p>
<pre><code class="language-python">from ecm.tools.item_registry_v2 import ItemRegistry
@ItemRegistry.register(package=&quot;keyboard&quot;)
def press_A():
  &quot;&quot;&quot;I press the Key A&quot;&quot;&quot;
  ...
@ItemRegistry.register(package=&quot;keyboard&quot;)
def press_B():
  &quot;&quot;&quot;I press the Key A&quot;&quot;&quot;
  ...

ItemRegistry().load_package(&quot;keyboard&quot;)
</code></pre>
<blockquote>
<p>Note: Some functions in this repository are still using the version V1 of the ItemRegistry to maintain backward-compatibility and thus, cannot be encapsulated into a package.</p>
</blockquote>
<h2 id="extracting-actions-and-tools">Extracting Actions and Tools</h2>
<p>Now that you know how to integrate actions and tools, you can exit here if you only are going to use these registry for building new actions or tools to AI's (all the agents extract their capacities from this registry). However, if you are building your own agent, you will need to know how to manage the actions and tools saved in the ItemRegistry.</p>
<p>All the functions that are labeled as actions, will be saved in the following dataclass:</p>
<pre><code class="language-python">@dataclass
class Action(Item):
    name: str
    content: Callable
    description: str
    is_callable: bool = True
</code></pre>
<p>As you can see, the name of the function, callable itself and a description are mandatory, and will be automatically retrieved when using <code>ItemRegistry.register</code> from the name of the function and docstring.</p>
<p>In the other hand, the Tools have the following dataclass:</p>
<pre><code class="language-python">class Tool(Item):
    name: str
    content: Callable
    is_callable: bool = True
</code></pre>
<p>Similar to the actions the contain a callable, but they not enforce a docstring.</p>
<p>Note that if you want to add some metadata to the tools or actions you can use the <code>.label</code>property inherited from the <code>Item</code> class. For example, if you want to mark the tool as dangerous you could add:</p>
<pre><code class="language-python"># .label is a list[str]

item = Item(&quot;fire&quot;, do_fire)
item.label.append(&quot;danger&quot;)
</code></pre>
<p>All the information about this classes can be found at the <a href="https://github.com/SamthinkGit/GU-systems/blob/main/ecm/tools/item_registry_v2.py">item_registry_v2.py</a> file.</p>
<p>Now if you want to extract the actions or tools that have been loaded into a registry (for example using <code>load_all()</code>) you can access the <code>.tools</code> or <code>.actions</code> dictionaries, that will return the items by giving their name:</p>
<pre><code class="language-python">registry = ItemRegistry()

all_actions_loaded = registry.actions.values()     # -&gt; list[Action]
all_tools_loaded = registry.tools.values()         # -&gt; list[Tool]

screenshot = registry.actions[&quot;screenshot&quot;]
screenshot()

press_A = registry.actions[&quot;keyboard.press_A&quot;]
press_A
</code></pre>
<blockquote>
<p>Note: The actions saved inside a package will be accessible by using their package name followed with a dot. This enables to have multiple actions with the same name, however, is generally not a good idea to use them at the same time, since the AI could missunderstand the difference between each one</p>
</blockquote>
<h2 id="some-addons">Some Addons</h2>
<p>When developing using the ItemRegistry, we enable to use some tools that will ease the debug of the actions:</p>
<ul>
<li><strong>Invalidation</strong>: By invalidating a registry, all the actions and tools saved will be replaced with a mock that won't execute the function itself but a logging method that will act as the function. For example you could use this to simulate the AI could call a function that shut downs the pc:</li>
</ul>
<pre><code class="language-python">registry = ItemRegistry()
registry.invalidate()

mock = registry.actions[&quot;shutdown&quot;]
mock(&quot;now&quot;, force=True)
</code></pre>
<pre><code class="language-bash"># Output
-&gt; mock([now], {force: True})
</code></pre>
<ul>
<li>
<p><strong>Remote Execution</strong>: The ItemRegistry can be configured to be used on a remote machine, obtain more infomation at the <a href="https://github.com/SamthinkGit/GU-systems/wiki/Remote-Execution">RemoteExecution Guide</a></p>
</li>
<li>
<p><strong>Alias</strong>: You can add multiple names to the same function, this is useful for AI when it hallucinates different names for an specific function. Inside the ItemRegistry, they will be saved as different functions:</p>
</li>
</ul>
<pre><code class="language-python">
@ItemRegistry.alias([
  &quot;type&quot;,
  &quot;write_text&quot;,
])
@ItemRegistry.register(type=&quot;action&quot;)
def write(text: str):
  &quot;&quot;&quot;Explanation...&quot;&quot;&quot;
  ...
</code></pre>
<blockquote>
<p>Note: Alias only works for action not tools.</p>
<p>This could enlarge the size of your prompt (thera are more actions to be explained), add at most 1 or 2 aliases.</p>
</blockquote>
<h2 id="conclusion">Conclusion</h2>
<p>With this you have fully learned how to use the ItemRegistry, this class is used in multiple layers over the system such as interpreters, exelent parsers, agents...</p>
<p>You can try to add your own actions and register them to the default ItemRegistry, they should be automatically used in the agents integrated in this repo.</p>
<blockquote>
<p>Note: The deprecated version ItemRegistryV1 can be still found at <a href="https://github.com/SamthinkGit/GU-systems/blob/main/ecm/tools/item_registry_v1.py">/ecm/tools/item_registry_v1.py</a>. The file <a href="https://github.com/SamthinkGit/GU-systems/blob/main/ecm/tools/item_registry_v2.py">/ecm/tools/registry.py</a> will automatilcally redirect to the v2 registry. This class has been intended to be backward-compatible but the previus versions will not be continuated. If you want to disable the enforcing of the version v2, you can change the flag <code>PATCH_ITEM_REGISTRY_V1</code> at the <a href="https://github.com/SamthinkGit/GU-systems/blob/main/ecm/constants.py">constats.py</a> file.</p>
</blockquote></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
